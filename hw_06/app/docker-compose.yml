version: "3.9"
services:
  mariadb:
    image: lscr.io/linuxserver/mariadb:latest
    container_name: mariadb
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - MYSQL_ROOT_PASSWORD=root
      - TZ=America/Los_Angeles
    volumes:
      - /Users/adriankieback/Documents/SDSU/2.Semester/Machine_Learning_BDA_602/Github/BDA602_Kieback/hw_06/app:/config
    ports:
      - 3307:3306
    restart: unless-stopped

  hw_06:
    image: mysql:latest
    depends_on:
      - mariadb
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=baseball
    volumes:
      - ./baseball.sql:/docker-entrypoint-initdb.d/baseball.sql
      - ./hw_05.sql:/docker-entrypoint-initdb.d/hw_05.sql
    command:
      [
        "sh",
        "-c",
        "sleep 10 && until mysql -uroot -proot -hmariadb -e 'SELECT 1'; do sleep 1; done; mysql -uroot -proot -hmariadb baseball < /docker-entrypoint-initdb.d/baseball.sql && mysql -uroot -proot -hmariadb baseball < /docker-entrypoint-initdb.d/hw_05.sql",
      ]
